<!-- Documento HTML que define la estructura de la página de registro -->
<!-- HTML document defining the structure of the registration page -->
<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Metadatos del documento y enlace a los estilos -->
    <!-- Document metadata and stylesheet link -->
    <meta charset="utf-8">
    <title>Crear cuenta</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">

    <!-- Estilos internos para la página -->
    <!-- Internal styles for the page -->
    <style>
        /* Variables de color para el tema */
        /* Color variables for the theme */
        :root { --bg:#f6ece3; --card:#fff; --stroke:#ead8ce; --text:#2b2b2b; --muted:#9a7d72; --brand:#c77462; }

        /* Configuración de caja y estilo global */
        /* Box model and global style setup */
        *{box-sizing:border-box}

        /* Estilo principal del cuerpo del documento */
        /* Main body style */
        body{min-height:100vh;margin:0;display:grid;place-items:center;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;color:var(--text)}

        /* Estilo de la tarjeta principal */
        /* Main card style */
        .card{width:min(560px,94vw);background:var(--card);border:1px solid var(--stroke);border-radius:16px;box-shadow:0 12px 28px rgba(0,0,0,.06)}

        /* Cuerpo interno de la tarjeta */
        /* Inner body of the card */
        .body{padding:28px}

        /* Título principal */
        /* Main heading */
        h1{margin:0 0 10px}

        /* Espaciado de grupos de campos */
        /* Field group spacing */
        .group{margin:14px 0}

        /* Estilo de etiquetas */
        /* Label style */
        label{font-weight:600;display:block;margin:0 0 6px}

        /* Estilo de los campos de entrada */
        /* Input field style */
        input{width:100%;padding:12px 14px;border:1px solid #dec6bb;border-radius:12px;font-size:1rem}

        /* Configuración de filas flexibles */
        /* Flexible row layout */
        .row{display:flex;gap:12px;margin-top:14px}

        /* Distribución equitativa de columnas */
        /* Equal distribution of columns */
        .row.two > *{flex:1}

        /* Estilos de los botones */
        /* Button styles */
        .btn{border-radius:12px;padding:12px 16px;font-weight:700;border:1px solid var(--brand);cursor:pointer}

        /* Botón principal */
        /* Primary button */
        .btn.primary{background:var(--brand);color:#fff}

        /* Botón de tipo fantasma (sin fondo) */
        /* Ghost button (transparent background) */
        .btn.ghost{background:transparent;color:var(--brand)}

        /* Texto de error */
        /* Error text */
        .error{color:#8b1a1a;font-size:.9rem;margin-top:6px}

        /* Mensaje de alerta general */
        /* General alert message */
        .alert{padding:12px 14px;border-radius:12px;margin:10px 0;background:#fde8e8;border:1px solid #f4b4b4;color:#8b1a1a}

        /* Icono de mostrar/ocultar contraseña */
        /* Show/hide password icon */
        .pw-toggle{position:absolute;right:12px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:.9rem;color:var(--muted)}

        /* Contenedor relativo para el campo de contraseña */
        /* Relative container for password field */
        .pw-wrap{position:relative}
    </style>
</head>

<body>
<!-- Contenedor principal de la tarjeta -->
<!-- Main card container -->
<div class="card">
    <div class="body">
        <!-- Título de la página -->
        <!-- Page title -->
        <h1>Crear cuenta</h1>

        <!-- Descripción breve -->
        <!-- Short description -->
        <p style="color:var(--muted);margin-top:0">Regístrate para empezar a usar ServiExpress.</p>

        <!-- Resumen de errores globales -->
        <!-- Global error summary -->
        <div class="alert" th:if="${#fields.hasGlobalErrors()}"
             th:each="e : ${#fields.globalErrors()}" th:text="${e}">Hay errores en el formulario.</div>

        <!-- Formulario de registro -->
        <!-- Registration form -->
        <form th:action="@{/auth/registro}" th:object="${form}" method="post" novalidate>

            <!-- Campo: Nombre -->
            <!-- Field: Name -->
            <div class="group">
                <label for="nombreUsuario">Nombre</label>
                <input id="nombreUsuario" th:field="*{nombreUsuario}" placeholder="Tu nombre"
                       maxlength="80" autocomplete="name" required>
                <div class="error" th:if="${#fields.hasErrors('nombreUsuario')}" th:errors="*{nombreUsuario}"></div>
            </div>

            <!-- Campo: Correo electrónico -->
            <!-- Field: Email -->
            <div class="group">
                <label for="correo">Correo</label>
                <input id="correo" type="email" th:field="*{correo}" placeholder="tucorreo@dominio.com"
                       maxlength="120" autocomplete="email" required>
                <div class="error" th:if="${#fields.hasErrors('correo')}" th:errors="*{correo}"></div>
            </div>

            <!-- Fila con dos columnas: Teléfono y Ciudad -->
            <!-- Row with two columns: Phone and City -->
            <div class="row two">

                <!-- Campo: Teléfono -->
                <!-- Field: Phone -->
                <div class="group">
                    <label for="telefono">Teléfono</label>
                    <input id="telefono" th:field="*{telefono}" placeholder="300 123 4567"
                           inputmode="tel" autocomplete="tel" required>
                    <div class="error" th:if="${#fields.hasErrors('telefono')}" th:errors="*{telefono}"></div>
                </div>

                <!-- Campo: Ciudad -->
                <!-- Field: City -->
                <div class="group">
                    <label for="ciudad">Ciudad</label>
                    <input id="ciudad" th:field="*{ciudad}" placeholder="Tu ciudad"
                           maxlength="100" autocomplete="address-level2" required>
                    <div class="error" th:if="${#fields.hasErrors('ciudad')}" th:errors="*{ciudad}"></div>
                </div>
            </div>

            <!-- Campo: Contraseña -->
            <!-- Field: Password -->
            <div class="group">
                <label for="password">Contraseña</label>
                <div class="pw-wrap">
                    <input id="password" type="password" th:field="*{password}" minlength="6" maxlength="120"
                           autocomplete="new-password" required>
                    <span class="pw-toggle" data-target="password">mostrar</span>
                </div>
                <div class="error" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
            </div>

            <!-- Campo: Confirmar contraseña -->
            <!-- Field: Confirm password -->
            <div class="group">
                <label for="confirmarPassword">Confirmar contraseña</label>
                <div class="pw-wrap">
                    <input id="confirmarPassword" type="password" th:field="*{confirmarPassword}" minlength="6" maxlength="120"
                           autocomplete="new-password" required>
                    <span class="pw-toggle" data-target="confirmarPassword">mostrar</span>
                </div>
                <div class="error" th:if="${#fields.hasErrors('confirmarPassword')}" th:errors="*{confirmarPassword}"></div>
            </div>

            <!-- Token CSRF de seguridad -->
            <!-- CSRF security token -->
            <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

            <!-- Botones de acción -->
            <!-- Action buttons -->
            <div class="row">
                <a class="btn ghost" th:href="@{/auth/login}">Ya tengo cuenta</a>
                <button class="btn primary" type="submit">Crear cuenta</button>
            </div>
        </form>
    </div>
</div>

<!-- Script para alternar la visibilidad de contraseñas -->
<!-- Script to toggle password visibility -->
<script>
    document.querySelectorAll('.pw-toggle').forEach(t => {
        // Escucha el clic en el icono
        // Listen for click on the icon
        t.addEventListener('click', () => {
            const id = t.getAttribute('data-target'); // Obtiene el id del input
            const input = document.getElementById(id);
            const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
            input.setAttribute('type', type);
            t.textContent = type === 'password' ? 'mostrar' : 'ocultar'; // Cambia el texto
        });
    });
</script>
</body>
</html>
